# THIS CODE WAS AUTOGENERATED. DO NOT MODIFY THIS FILE DIRECTLY
# THE SOURCE CODE LIVES IN A DIFFERENT REPOSITORY:
#   - centralized-templates
# FILE STEWARD: @pleo-io/team-security


name: Security Workflows

on:
  push:
    branches:
      - main
      - master
      - develop
  pull_request:
    branches:
      - main
      - master
      - develop
  merge_group:
    types: [checks_requested]

jobs:
  wiz-cli-scanning:
    if: ${{ !contains(github.event.pull_request.title, 'deps') }}
    name: Scan Dependencies, Containers or IaC with Wiz-CLI
    uses: pleo-io/reusable-workflows/.github/workflows/security-analysis-with-wiz.reusable-external.yaml@main
    permissions:
      security-events: write
      actions: read
      contents: read
    secrets: inherit
    with:
      # Dependency Scanning Inputs
      wiz_scan_deps: true
      wiz_scan_deps_path: "."
      wiz_scan_deps_policy: "Pleo-Default-vulnerabilities-policy"
      # Container Scanning Inputs
      wiz_scan_container: true
      wiz_scan_container_policy: "Pleo-Default-container-policy"
      wiz_scan_container_dockerfile_path: "."
      jdk_version: "21"
      node_version: 22
      # IaC Scanning Inputs
      wiz_scan_iac: false
      wiz_scan_iac_path: "."
      wiz_scan_iac_policy: "Pleo-Default-IaC-policy"

  codeql-analyse:
    name: CodeQL Analysis Scanning
    uses: pleo-io/reusable-workflows/.github/workflows/codeql-analysis.yaml@main
    with:
      codeQlConfigFile: ""
      codeQlRunOnDefaultBranch: true
      jdkVersion: "21"
      nodeVersion: 22
    secrets: inherit
